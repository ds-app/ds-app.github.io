!function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){n(1),n(2),n(3),n(4),n(5),n(6),n(7),n(8),n(9),n(10),n(11),n(12),n(13),n(14),n(15),n(16),n(17),n(18),n(19),n(20),n(21),t.exports=n(22)},function(t,e){"use strict";t.exports=angular.module("DongsuApp",["templates-html","ngTouch","rx"]).config(["$compileProvider","$httpProvider",function(t,e){t.debugInfoEnabled(!1),e.useApplyAsync(!0)}])},function(t,e,n){"use strict";function r(t,e){var n=t.Status,r=t.status();(r==n.ON&&!e.isRecording()||r==n.OFF&&e.isRecording())&&e.toggle()}r.$inject=["Storage","Ticker"],n(1).run(r)},function(t,e,n){"use strict";function r(t){return function(e){return t.time(e)||"00:00"}}function i(t){return function(e){return t.minute(e)}}function o(t){return function(e){return t.date(e)}}function u(){return function(t){return t||"00:00"}}r.$inject=["Util"],i.$inject=["Util"],o.$inject=["Util"],n(1).filter("time",r).filter("minute",i).filter("date",o).filter("timeholder",u)},function(t,e,n){"use strict";n(1).service("$localStorage",function(){return localStorage})},function(t,e,n){"use strict";n(1).value("Sample",{"2016-05-23":{first:"2016-05-22T21:00:31.000Z",last:"2016-05-23T17:38:31.000Z",excepts:[{label:0,time:25},{label:1,time:73}],type:"8h"},"2016-05-24":{first:"2016-05-24T00:00:23.000Z",last:"2016-05-24T12:22:31.000Z",excepts:[{label:0,time:25},{label:1,time:53}],type:"8h"},"2016-05-25":{first:"2016-05-25T01:00:23.000Z",last:"2016-05-25T07:22:31.000Z",excepts:[{label:0,time:48},{label:1,time:23}],type:"4h"}})},function(t,e,n){"use strict";function r(t,e,n){function r(e){return e?void t.setItem(c,e):t.getItem(c)||s.OFF}function i(t){var e=moment(t).day();return 0==e||6==e?{excepts:[],type:$.HOLIDAY}:{excepts:[],type:$.FULL}}function l(){var r=JSON.parse(t.getItem(o)||"{}");return _(e.workWeek()).map(function(t){return _.extend({},r[t]||i(t),{workDate:t})}).map(function(t){return _.extend(t,n.getWorkingTime(t))}).value()}function f(){return w}function m(){return _.find(k,function(t){return t.workDate==n.getWorkDate()})}function d(){return k}function p(){var e=_.map(w,function(t){return _.pick(t,["name","color"])});t.setItem(u,JSON.stringify(e))}function v(){var e=_(k).keyBy("workDate").mapValues(function(t){return _.pick(t,["first","last","excepts","type"])}).value();t.setItem(o,JSON.stringify(e))}function g(t){var e=_.extend(t,n.getWorkingTime(t));return v(),e}var h=this,$=n.WORK_TYPE,k=l(),w=JSON.parse(t.getItem(u))||a;h.load=d,h.today=m,h.update=g,h.getLabels=f,h.storeLabels=p,h.Status=s,h.status=r}r.$inject=["$localStorage","Week","Time"],n(1).service("Storage",r);var i="DONSU@2.0-",o=i+"WORKS",u=i+"LABELS",c=i+"STATUS",a=[{name:"기타"},{name:"헬스",color:"#C05B4B"},{name:"",color:"#97A82D"},{name:"",color:"#F68923"}],s={ON:"ON",OFF:"OFF"}},function(t,e,n){"use strict";function r(t,e,n){function r(t){return n.Observable.interval(t).map(function(){return moment().startOf("minute")}).distinct()}function i(){return a?u():o()}function o(){c=f.subscribe({onNext:function(n){t.$apply(function(){a=!0,s.first||(s.first=n.toISOString()),s.last=n.toISOString(),e.update(s),e.status(l.ON)})}})}function u(){c&&c.dispose(),e.status(l.OFF),a=!1}var c,a=!1,s=e.today(),l=e.Status,f=r(500),m={isRecording:function(){return a},toggle:i};return m}r.$inject=["$rootScope","Storage","rx"],n(1).factory("Ticker",r)},function(t,e,n){"use strict";function r(){function t(t){var e=moment(t);return e.utcOffset(e.utcOffset()-m).format("YYYY-MM-DD")}function e(t,e){var n=moment(t),r=moment.utc(e,"HH:mm"),i=r.hours(),o=r.minutes();return m>60*i+o&&n.add(1,"d"),n.hours(i).minutes(o)}function n(t,e){return e!=i.DAY_OFF?0>t?0:240>t?t:270>t?240:480>t?t-30:t-60:Math.max(t,0)}function r(t,e){return e==i.DAY_OFF?0:Math.max(Math.min(t,720),0)}function o(t,e){return Math.max(t-_.sumBy(e,function(t){return t.time}),0)}function u(t){var e=t-480;return 120>e?0:240>e?2:360>e?4:6}function c(t){return 240>t?0:360>t?4:480>t?6:8}function a(t){return t.first&&t.last?s(t):{total:0,working:0,effective:0,extra:0}}function s(e){var a,s,l,f,d,p=moment(e.first),v=moment(e.last),g=t(p),h=t(v);return g>h?0:(h>g&&(v=moment(g).endOf("date").add(m,"m")),a=v.diff(p,"minutes"),s=n(a,e.type),l=r(s,e.type),f=o(s,e.excepts),d=e.type==i.HOLIDAY?c(f):u(f),{total:a,digested:s,working:l,effective:f,extra:d})}function l(t){switch(t){case i.HALF:return"Half";case i.DAY_OFF:return"Day Off";case i.HOLIDAY:return"Holiday";case i.FULL:default:return"Full"}}var f=this,m=300;f.getWorkDate=t,f.getWorkingTime=a,f.getTime=e,f.getTypeName=l,f.WORK_TYPE=i}n(1).service("Time",r);var i={HOLIDAY:"NA",DAY_OFF:"0h",HALF:"4h",FULL:"8h"}},function(t,e,n){"use strict";function r(){function t(t){var e=""+t;return("00"+e).substr(Math.min(e.length,2))}function e(e){if(e){var n,r;return n=parseInt(e/60),r=e-60*n,t(n)+":"+t(r)}}function n(t,e){return t?moment(t).format(e||"HH:mm"):void 0}function r(t,e){return t?moment(t).format(e||"MM/DD"):void 0}var i=this;i.time=e,i.minute=n,i.date=r}n(1).service("Util",r)},function(t,e,n){"use strict";function r(t){function e(){var e=moment(t.getWorkDate());return e.subtract((e.day()+6)%7,"d"),e.subtract(7,"d"),_(14).range().map(function(t){return moment(e).add(t,"d").format("YYYY-MM-DD")}).reverse().value()}var n=this;n.workWeek=e}r.$inject=["Time"],n(1).service("Week",r)},function(t,e,n){"use strict";function r(t,e,n){function r(){return c()>=100}function i(){return Math.max(o()-u(),0)}function o(){return _(f).map(function(t){return t.type}).map(function(t){switch(t){case m.FULL:return 480;case m.HALF:return 240;default:return 0}}).sum()}function u(){return _(f).map(function(t){return t.working}).sum()}function c(){var t=Math.floor(100*u()/o());return 0>=t?0:5>=t?5:Math.min(t,100)}function a(){return{width:c()+"%"}}function s(){return n.isRecording()}var l=this,f=e.load().slice(0,7),m=t.WORK_TYPE;l.today=e.today(),l.getFullWorkingTime=o,l.getTotalWorkedTime=u,l.getRemainTime=i,l.getWorkedGauge=a,l.isFull=r,l.isRecording=s}function i(){return{restrict:"E",templateUrl:"views/board.tpl.html",controller:r,controllerAs:"board"}}r.$inject=["Time","Storage","Ticker"],n(1).directive("dsBoard",i)},function(t,e,n){"use strict";function r(t,e,n){var r=n.dsChange;t.$watch(function(){return e.val()},function(e,n){e!==n&&t.$eval(r,{$value:e})}),e.on("change",function(){t.$apply()})}function i(){return{restrict:"A",controller:r}}r.$inject=["$scope","$element","$attrs"],n(1).directive("dsChange",i)},function(t,e,n){"use strict";function r(t,e,n){var r=n.dsTimeValue;t.$watch(r,function(t,n){e.val(t)})}function i(){return{restrict:"A",controller:r}}r.$inject=["$scope","$element","$attrs"],n(1).directive("dsTimeValue",i)},function(t,e,n){"use strict";function r(t,e,n,r){function i(){p.first=n.minute(v.first),p.last=n.minute(v.last)}function o(){return _.sumBy(v.excepts,"time")}function u(t,n){return t?e.getTime(v.workDate,t).toISOString():void 0}function c(t){return v.first=u(t,v.first),r.update(v)}function a(t){return v.last=u(t,v.last),r.update(v)}function s(t){t||(p.modify=!1,p.flip=!0)}function l(t){p.lap=t}function f(t){var e=p.lap.val();e&&(v.excepts.push({label:_.findIndex(r.getLabels(),t),time:e}),r.update(v),s())}function m(t){var e=_.findIndex(v.excepts,t),n=confirm("Are you sure you want delete?");n&&e>=0&&(v.excepts.splice(e,1),r.update(v))}function d(t){return!!t.name}var p=this,v=t.$eval("works");p.getTotal=o,p.setFirst=c,p.setLast=a,p.addLap=l,p.add=f,p.remove=m,p.flip=!0,p.labelFilter=d,t.$watch("work.flip",s),t.$watch("week.edit",s),t.$watch(function(){return v.first},i),t.$watch(function(){return v.last},i)}function i(){return{restrict:"E",templateUrl:"views/excepts.tpl.html",controller:r,controllerAs:"excepts"}}r.$inject=["$scope","Time","Util","Storage"],n(1).directive("dsExcepts",i)},function(t,e,n){"use strict";function r(t,e,n,r){function i(){u.name=c.name,e.css({"background-color":c.color||"#90AFAA"}),t.$watch("label.name",function(t){c.name=t,r.storeLabels()})}function o(){return t.$eval(a)}var u=this,c=t.$eval(n.label),a=n.modify;u.isEditable=o,i()}function i(){return{template:'<span class="label"><input type="text" ng-model="label.name" ng-disabled="!label.isEditable()"/></span>',replace:!0,controller:r,controllerAs:"label"}}r.$inject=["$scope","$element","$attrs","Storage"],n(1).directive("dsLabel",i)},function(t,e,n){"use strict";function r(t,e){function n(){t.$apply()}function r(t){return 0==t||t>0}function i(t,e,n){return e>t?e:t>n?n:t}function o(){24==l.hours&&l.minute>0&&(l.hours=23),a.val(r(l.hours)?l.hours:""),s.val(r(l.minute)?l.minute:"")}function u(t){if(r(t))l.hours=i(~~(t/60),0,24),l.minute=t%60,o();else if(""==t)l.hours=void 0,l.minute=void 0,o();else if(void 0!=l.hours||void 0!=l.minute)return 60*(l.hours||0)+(l.minute||0)}var c=this,a=e.find(".lap_time_hours"),s=e.find(".lap_time_minute"),l={hours:void 0,minute:void 0};c.val=u,a.on("change",n),s.on("change",n),t.$watch("excepts.flip",function(t){t&&u("")}),t.$watch(function(){return a.val()},function(t){""!=t&&(l.hours=i(+t,0,24),o())}),t.$watch(function(){return s.val()},function(t){""!=t&&(l.minute=i(+t,0,59),o())}),c.onLoad({$lap:c})}function i(){return{restrict:"E",templateUrl:"views/lapTime.tpl.html",scope:{onLoad:"&"},controller:r,controllerAs:"lap",bindToController:!0}}r.$inject=["$scope","$element"],n(1).directive("lapTime",i)},function(t,e,n){"use strict";function r(t){var e=this;e.data=t.load()}function i(){return{restrict:"E",templateUrl:"views/main.tpl.html",controller:r,controllerAs:"main"}}r.$inject=["Storage"],n(1).directive("dsMain",i)},function(t,e,n){"use strict";function r(t,e,n,r){function i(t){return s.type==t}function o(){return l?"Today":n.date(s.workDate)}function u(){return l}function c(t){s.type=t,r.update(s)}var a=this,s=t.$eval("works"),l=s.workDate==e.getWorkDate();a.work=s,a.isSelected=i,a.getDate=o,a.isToday=u,a.select=c}function i(){return{restrict:"A",templateUrl:"views/mode.tpl.html",replace:!0,controller:r,controllerAs:"mode"}}r.$inject=["$scope","Time","Util","Storage"],n(1).directive("dsMode",i)},function(t,e,n){"use strict";function r(t,e,n,r){function i(){var t=f.type==m.HOLIDAY?u:o;return _.map(t,function(t){return{title:t.title,time:function(){var e=moment(f.first).add(t.offset,"m");return t.except&&e.add(c(),"m"),e.toISOString()}}})}function c(){return _.sumBy(f.excepts,"time")}function a(t){return moment().isSameOrAfter(t)}function s(){var t=_(l.list).filter(function(t){return!a(t.time())}).head();return""+t.title+" 까지 "+r.time(moment(t.time()).diff(moment(),"minutes"))+" 남음"}var l=this,f=e.today(),m=n.WORK_TYPE;l.flip=!0,l.list=i(),l.isPast=a,l.message=s,t.$watch(function(){return f.type},function(){l.list=i()})}function i(){return{restrict:"E",templateUrl:"views/summaries.tpl.html",controller:r,controllerAs:"summaries"}}r.$inject=["$scope","Storage","Time","Util"],n(1).directive("dsSummaries",i);var o=[{title:"출근",offset:0},{title:"전반 종료",offset:240},{title:"후반 시작",offset:270},{title:"중요 시점",offset:480},{title:"후반 종료",offset:540},{title:"추가 2시간",offset:660,except:!0},{title:"추가 4시간",offset:780,except:!0},{title:"추가 6시간",offset:900,except:!0}],u=[{title:"근무 4시간",offset:240,except:!0},{title:"근무 6시간",offset:360,except:!0},{title:"근무 8시간",offset:480,except:!0}]},function(t,e,n){"use strict";function r(t){function e(){r.edit=!r.edit}function n(t,e){return!(r.flip&&e>=7)}var r=this;r.toggle=e,r.edit=!1,r.labels=t.getLabels(),r.more=n,r.flip=!0}function i(){return{restrict:"E",templateUrl:"views/week.tpl.html",controller:r,controllerAs:"week"}}r.$inject=["Storage"],n(1).directive("dsWeek",i)},function(t,e,n){"use strict";function r(t,e,n){function r(){c.flip=!c.flip}function i(){return s?"Today":n.date(a.workDate)}function o(){return s}function u(){return e.getTypeName(a.type)}var c=this,a=t.$eval("works"),s=a.workDate==e.getWorkDate();c.work=a,c.flip=!s,c.toggle=r,c.getDate=i,c.isToday=o,c.getTypeName=u}function i(){return{restrict:"A",templateUrl:"views/work.tpl.html",replace:!0,controller:r,controllerAs:"work"}}r.$inject=["$scope","Time","Util"],n(1).directive("dsWork",i)},function(t,e,n){"use strict";function r(t){function e(){return t.isRecording()}var n=this;n.isRecording=t.isRecording,n.toggle=t.toggle,n.isRecording=e}function i(){return{restrict:"E",templateUrl:"views/workBtn.tpl.html",controller:r,controllerAs:"btns"}}r.$inject=["Ticker"],n(1).directive("dsWorkBtn",i)}]);